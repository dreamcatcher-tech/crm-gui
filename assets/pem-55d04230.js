import{r as T,c as pe,a as ge}from"./index-b374196a.js";function Ee(e,n){for(var i=0;i<n.length;i++){const t=n[i];if(typeof t!="string"&&!Array.isArray(t)){for(const r in t)if(r!=="default"&&!(r in e)){const s=Object.getOwnPropertyDescriptor(t,r);s&&Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:()=>t[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var g={},D={};Object.defineProperty(D,"__esModule",{value:!0});D.promisify=M;var X="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function M(e){if(typeof e!="function")throw new TypeError("Argument to promisify must be a function");var n=e[X],i=M.Promise||Promise;if(typeof i!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var t=this,r=arguments.length,s=new Array(r),f=0;f<r;f++)s[f]=arguments[f];return new i(function(u,c){s.push(function(d){if(d)return c(d);for(var a=arguments.length,h=new Array(a>1?a-1:0),v=1;v<a;v++)h[v-1]=arguments[v];if(h.length===1||!n)return u(h[0]);var l={};h.forEach(function(y,F){var G=n[F];G&&(l[G]=y)}),u(l)}),e.apply(t,s)})}}M.argumentNames=X;M.Promise=void 0;var S={},Pe={get exports(){return S},set exports(e){S=e}},Q=process.platform==="win32",ye=Q?/[^:]\\$/:/.\/$/,z=function(){var e;return Q?e={}.TEMP||{}.TMP||({}.SystemRoot||{}.windir)+"\\temp":e={}.TMPDIR||{}.TMP||{}.TEMP||"/tmp",ye.test(e)&&(e=e.slice(0,-1)),e};(function(e){var n=T,i=T,t=T,r=z,s={}.PEMJS_TMPDIR||r();e.exports.isNumber=function(u){return Array.isArray(u)?!1:/^\d+$/g.test(u)},e.exports.isHex=function(c){return/^(0x){0,1}([0-9A-F]{1,40}|[0-9A-F]{1,40})$/gi.test(c)},e.exports.toHex=function(c){for(var o="",d=0;d<c.length;d++)o+=""+c.charCodeAt(d).toString(16);return o},e.exports.ciphers=["aes128","aes192","aes256","camellia128","camellia192","camellia256","des","des3","idea"];var f=e.exports.ciphers;e.exports.createPasswordFile=function(u,c,o){if(!u||!Object.prototype.hasOwnProperty.call(u,"password")||!Object.prototype.hasOwnProperty.call(u,"passType")||!/^(word|in|out)$/.test(u.passType))return!1;var d=n.join(s,t.randomBytes(20).toString("hex"));return o.push(d),u.password=u.password.trim(),u.password===""&&(u.mustPass=!0),u.cipher&&f.indexOf(u.cipher)!==-1&&c.push("-"+u.cipher),c.push("-pass"+u.passType),u.mustPass?c.push("pass:"+u.password):(i.writeFileSync(d,u.password),c.push("file:"+d)),!0},e.exports.deleteTempFiles=function(u,c){var o=[];if(typeof u=="string")o.push(u);else if(Array.isArray(u))o=u;else return c(new Error("Unexcepted files parameter type; only string or array supported"));var d=function(a,h){if(a.length){var v=a.shift(),l=function(y){return y&&y.code==="ENOENT"?d(a,h):y?h(y):d(a,h)};if(v&&typeof v=="string")i.unlink(v,l);else return d(a,h)}else return h(null)};d(o,c)}})(Pe);var L,B;function me(){if(B)return L;B=1,L=t,t.sync=r;var e=T;function n(s,f){var u=f.pathExt!==void 0?f.pathExt:{}.PATHEXT;if(!u||(u=u.split(";"),u.indexOf("")!==-1))return!0;for(var c=0;c<u.length;c++){var o=u[c].toLowerCase();if(o&&s.substr(-o.length).toLowerCase()===o)return!0}return!1}function i(s,f,u){return!s.isSymbolicLink()&&!s.isFile()?!1:n(f,u)}function t(s,f,u){e.stat(s,function(c,o){u(c,c?!1:i(o,s,f))})}function r(s,f){return i(e.statSync(s),s,f)}return L}var O,H;function Te(){if(H)return O;H=1,O=n,n.sync=i;var e=T;function n(s,f,u){e.stat(s,function(c,o){u(c,c?!1:t(o,f))})}function i(s,f){return t(e.statSync(s),f)}function t(s,f){return s.isFile()&&r(s,f)}function r(s,f){var u=s.mode,c=s.uid,o=s.gid,d=f.uid!==void 0?f.uid:process.getuid&&process.getuid(),a=f.gid!==void 0?f.gid:process.getgid&&process.getgid(),h=parseInt("100",8),v=parseInt("010",8),l=parseInt("001",8),y=h|v,F=u&l||u&v&&o===a||u&h&&c===d||u&y&&d===0;return F}return O}var R;process.platform==="win32"||pe.TESTING_WINDOWS?R=me():R=Te();var we=Y;Y.sync=Ce;function Y(e,n,i){if(typeof n=="function"&&(i=n,n={}),!i){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(t,r){Y(e,n||{},function(s,f){s?r(s):t(f)})})}R(e,n||{},function(t,r){t&&(t.code==="EACCES"||n&&n.ignoreErrors)&&(t=null,r=!1),i(t,r)})}function Ce(e,n){try{return R.sync(e,n||{})}catch(i){if(n&&n.ignoreErrors||i.code==="EACCES")return!1;throw i}}const A=process.platform==="win32"||{}.OSTYPE==="cygwin"||{}.OSTYPE==="msys",Z=T,xe=A?";":":",J=we,V=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),b=(e,n)=>{const i=n.colon||xe,t=e.match(/\//)||A&&e.match(/\\/)?[""]:[...A?[process.cwd()]:[],...(n.path||{}.PATH||"").split(i)],r=A?n.pathExt||{}.PATHEXT||".EXE;.CMD;.BAT;.COM":"",s=A?r.split(i):[""];return A&&e.indexOf(".")!==-1&&s[0]!==""&&s.unshift(""),{pathEnv:t,pathExt:s,pathExtExe:r}},k=(e,n,i)=>{typeof n=="function"&&(i=n,n={}),n||(n={});const{pathEnv:t,pathExt:r,pathExtExe:s}=b(e,n),f=[],u=o=>new Promise((d,a)=>{if(o===t.length)return n.all&&f.length?d(f):a(V(e));const h=t[o],v=/^".*"$/.test(h)?h.slice(1,-1):h,l=Z.join(v,e),y=!v&&/^\.[\\\/]/.test(e)?e.slice(0,2)+l:l;d(c(y,o,0))}),c=(o,d,a)=>new Promise((h,v)=>{if(a===r.length)return h(u(d+1));const l=r[a];J(o+l,{pathExt:s},(y,F)=>{if(!y&&F)if(n.all)f.push(o+l);else return h(o+l);return h(c(o,d,a+1))})});return i?u(0).then(o=>i(null,o),i):u(0)},Ae=(e,n)=>{n=n||{};const{pathEnv:i,pathExt:t,pathExtExe:r}=b(e,n),s=[];for(let f=0;f<i.length;f++){const u=i[f],c=/^".*"$/.test(u)?u.slice(1,-1):u,o=Z.join(c,e),d=!c&&/^\.[\\\/]/.test(e)?e.slice(0,2)+o:o;for(let a=0;a<t.length;a++){const h=d+t[a];try{if(J.sync(h,{pathExt:r}))if(n.all)s.push(h);else return h}catch{}}}if(n.all&&s.length)return s;if(n.nothrow)return null;throw V(e)};var Fe=k;k.sync=Ae;var Se=S,Ie=T.spawn,Re=T,Ke=T,Me=z,Ne=T,_e=Fe,ee={},Le={}.PEMJS_TMPDIR||Me();function re(e,n){ee[e]=n}function ne(e){return ee[e]||null}function Oe(e,n,i,t){!t&&typeof i=="function"&&(t=i,i=!1),q(e,i,function(r,s,f,u){var c,o;return r?t(r):((c=f.match(new RegExp("\\-+BEGIN "+n+"\\-+$","m")))?c=c.index:c=-1,n==="EC PARAMETERS"&&(n="EC PRIVATE KEY"),(o=f.match(new RegExp("^\\-+END "+n+"\\-+","m")))?o=o.index+o[0].length:o=-1,c>=0&&o>=0?t(null,f.substring(c,o)):t(new Error(n+` not found from openssl output:
---stdout---
`+f+`
---stderr---
`+u+`
code: `+s)))})}function Ue(e,n,i){!i&&typeof n=="function"&&(i=n,n=!1),q(e,n,!0,function(t,r,s,f){return t?i(t):i(null,s)})}function $(e,n,i){var t=ne("pathOpenSSL")||{}.OPENSSL_BIN||"openssl";We(t,function(r){if(r)return i(r);var s=Ie(t,e),f="",u=n?Buffer.alloc(0):"";s.stdout.on("data",function(h){n?u=Buffer.concat([u,h]):u+=h.toString("binary")}),s.stderr.on("data",function(h){f+=h.toString("binary")});var c=2,o=-1,d=!1,a=function(h){if(!d){if(h)return d=!0,i(h);if(--c<1)return d=!0,o?o===2&&(f===""||/depth lookup: unable to/.test(f))?i(null,o,u,f):i(new Error("Invalid openssl exit code: "+o+`
% openssl `+e.join(" ")+`
`+f),o):i(null,o,u,f)}};s.on("error",a),s.on("exit",function(h){o=h,a()}),s.on("close",function(){u=n?u:Buffer.from(u,"binary").toString("utf-8"),f=Buffer.from(f,"binary").toString("utf-8"),a()})})}function q(e,n,i,t){!t&&typeof i=="function"&&(t=i,i=!1);var r=[],s=[];if(n){n=[].concat(n);var f,u;for(u=0;u<e.length;u++)e[u]==="--TMPFILE--"&&(f=Re.join(Le,Ne.randomBytes(20).toString("hex")),r.push({path:f,contents:n.shift()}),e[u]=f,s.push(f))}var c;for(u=0;u<r.length;u++)c=r[u],Ke.writeFileSync(c.path,c.contents);$(e,i,function(o,d,a,h){Se.deleteTempFiles(s,function(v){t(o||v,d,a,h)})})}function We(e,n){_e(e,function(i){if(i)return n(new Error("Could not find openssl on your system on this path: "+e));n()})}$(["version"],!1,function(e,n,i,t){var r=String(i)+`
`+String(t)+`
`+String(e),s=r.match(/^LibreSSL/i);re("openSslVersion",(s&&s[0]?"LibreSSL":"openssl").toUpperCase())});var ie={exec:Oe,execBinary:Ue,spawn:$,spawnWrapper:q,set:re,get:ne},x={},C=ie,w=S;x.PEM2DER=function(e,n,i,t){!t&&typeof i=="function"&&(t=i,i="x509");var r=[i,"-outform","der","-in",e,"-out",n];C.spawnWrapper(r,!1,function(s,f){s?t(s):t(null,f===0)})};x.DER2PEM=function(e,n,i,t){!t&&typeof i=="function"&&(t=i,i="x509");var r=[i,"-inform","der","-in",e,"-out",n];C.spawnWrapper(r,!1,function(s,f){s?t(s):t(null,f===0)})};x.PEM2P7B=function(e,n,i){var t=["crl2pkcs7","-nocrl","-certfile",e.cert,"-out",n];e.ca&&(Array.isArray(e.ca)||(e.ca=[e.ca]),e.ca.forEach(function(r){t.push("-certfile"),t.push(r)})),C.spawnWrapper(t,!1,function(r,s){r?i(r):i(null,s===0)})};x.P7B2PEM=function(e,n,i){var t=["pkcs7","-print_certs","-in",e,"-out",n];C.spawnWrapper(t,!1,function(r,s){r?i(r):i(null,s===0)})};x.PEM2PFX=function(e,n,i,t){var r=["pkcs12","-export","-out",n,"-inkey",e.key,"-in",e.cert];e.ca&&(Array.isArray(e.ca)||(e.ca=[e.ca]),e.ca.forEach(function(f){r.push("-certfile"),r.push(f)}));var s=[];w.createPasswordFile({cipher:"",password:i,passType:"in"},r,s),w.createPasswordFile({cipher:"",password:i,passType:"out"},r,s),C.spawnWrapper(r,!1,function(f,u){function c(o){o?t(o):t(null,u===0)}w.deleteTempFiles(s,function(o){c(f||o)})})};x.PFX2PEM=function(e,n,i,t){var r=["pkcs12","-in",e,"-out",n,"-nodes"],s=[];w.createPasswordFile({cipher:"",password:i,passType:"in"},r,s),w.createPasswordFile({cipher:"",password:i,passType:"out"},r,s),C.spawnWrapper(r,!1,function(f,u){function c(o){o?t(o):t(null,u===0)}w.deleteTempFiles(s,function(o){c(f||o)})})};x.P7B2PFX=function(e,n,i,t){var r=e.cert.replace(/\.[^.]+$/,".cer"),s=["pkcs7","-print_certs","-in",e.cert,"-out",r];C.spawnWrapper(s,!1,function(f,u){if(f)t(f);else{var c=["pkcs12","-export","-in",r,"-inkey",e.key,"-out",n];e.ca&&(Array.isArray(e.ca)||(e.ca=[e.ca]),e.ca.forEach(function(d){c.push("-certfile"),c.push(d)}));var o=[r];w.createPasswordFile({cipher:"",password:i,passType:"in"},c,o),w.createPasswordFile({cipher:"",password:i,passType:"out"},c,o),C.spawnWrapper(c,!1,function(d,a){function h(v){v?t(v):t(null,a===0)}w.deleteTempFiles(o,function(v){h(d||v)})})}})};const{promisify:P}=D;var U=T,p=S,E=ie,De=g.createPrivateKey=N,Ye=g.createDhparam=te,$e=g.createEcparam=se,qe=g.createCSR=_,je=g.createCertificate=K,Ge=g.readCertificateInfo=j,Be=g.getPublicKey=fe,He=g.getFingerprint=oe,Xe=g.getModulus=ue,Qe=g.getDhparamInfo=ae,ze=g.createPkcs12=ce,Ze=g.readPkcs12=he,Je=g.verifySigningChain=le,Ve=g.checkCertificate=de,be=g.checkPkcs12=ve,ke=g.config=or,er=g.convert=x,rr="-----BEGIN PRIVATE KEY-----",nr="-----END PRIVATE KEY-----",ir="-----BEGIN RSA PRIVATE KEY-----",tr="-----END RSA PRIVATE KEY-----",sr="-----BEGIN ENCRYPTED PRIVATE KEY-----",fr="-----END ENCRYPTED PRIVATE KEY-----",ur="-----BEGIN CERTIFICATE-----",ar="-----END CERTIFICATE-----";function N(e,n,i){!i&&!n&&typeof e=="function"?(i=e,e=void 0,n={}):!i&&e&&typeof n=="function"&&(i=n,n={}),e=Number(e)||2048;var t=["genrsa"],r=[];n&&n.cipher&&Number(p.ciphers.indexOf(n.cipher))!==-1&&n.password&&p.createPasswordFile({cipher:n.cipher,password:n.password,passType:"out"},t,r),t.push(e),E.exec(t,"RSA PRIVATE KEY",function(s,f){function u(c){if(c)return i(c);i(null,{key:f})}p.deleteTempFiles(r,function(c){u(s||c)})})}function te(e,n){!n&&typeof e=="function"&&(n=e,e=void 0),e=Number(e)||512;var i=["dhparam","-outform","PEM",e];E.exec(i,"DH PARAMETERS",function(t,r){return t?n(t):n(null,{dhparam:r})})}function se(e,n,i,t){!t&&typeof i>"u"&&!n&&typeof e=="function"?(t=e,e=void 0):!t&&typeof i>"u"&&e&&typeof n=="function"?(t=n,n=void 0):!t&&typeof i=="function"&&e&&n&&(t=i,i=void 0),e=e||"secp256k1",n=n||"explicit",i=i||!1;var r=["ecparam","-name",e,"-genkey","-param_enc",n],s="EC PARAMETERS";i&&(r.push("-noout"),s="EC PRIVATE KEY"),E.exec(r,s,function(f,u){return f?t(f):t(null,{ecparam:u})})}function _(e,n){if(!n&&typeof e=="function"&&(n=e,e=void 0),e=e||{},e.commonName&&(U.isIPv4(e.commonName)||U.isIPv6(e.commonName))&&(e.altNames?e.altNames.indexOf(e.commonName)===-1&&(e.altNames=e.altNames.concat([e.commonName])):e.altNames=[e.commonName]),!e.clientKey){N(e.keyBitsize||2048,function(c,o){if(c)return n(c);e.clientKey=o.key,_(e,n)});return}var i=["req","-new","-"+(e.hash||"sha256")];e.csrConfigFile?(i.push("-config"),i.push(e.csrConfigFile)):(i.push("-subj"),i.push(hr(e))),i.push("-key"),i.push("--TMPFILE--");var t=[e.clientKey],r=null;if(e.altNames&&Array.isArray(e.altNames)&&e.altNames.length){i.push("-extensions"),i.push("v3_req"),i.push("-config"),i.push("--TMPFILE--");for(var s=[],f=0;f<e.altNames.length;f++)s.push((U.isIP(e.altNames[f])?"IP":"DNS")+"."+(f+1)+" = "+e.altNames[f]);t.push(r=["[req]","req_extensions = v3_req","distinguished_name = req_distinguished_name","[v3_req]","subjectAltName = @alt_names","[alt_names]",s.join(`
`),"[req_distinguished_name]","commonName = Common Name","commonName_max = 64"].join(`
`))}else e.config&&(r=e.config);var u=[];e.clientKeyPassword&&p.createPasswordFile({cipher:"",password:e.clientKeyPassword,passType:"in"},i,u),E.exec(i,"CERTIFICATE REQUEST",t,function(c,o){function d(a){if(a)return n(a);n(null,{csr:o,config:r,clientKey:e.clientKey})}p.deleteTempFiles(u,function(a){d(c||a)})})}function K(e,n){if(!n&&typeof e=="function"&&(n=e,e=void 0),e=e||{},!e.csr){_(e,function(i,t){if(i)return n(i);e.csr=t.csr,e.config=t.config,e.clientKey=t.clientKey,K(e,n)});return}if(e.clientKey||(e.clientKey=""),!e.serviceKey)if(e.selfSigned)e.serviceKey=e.clientKey;else{N(e.keyBitsize||2048,function(i,t){if(i)return n(i);e.serviceKey=t.key,K(e,n)});return}j(e.csr,function(i,t){if(i)return n(i);var r=["x509","-req","-"+(e.hash||"sha256"),"-days",Number(e.days)||"365","-in","--TMPFILE--"],s=[e.csr],f=[];if(e.serviceCertificate?(r.push("-CA"),r.push("--TMPFILE--"),r.push("-CAkey"),r.push("--TMPFILE--"),e.serial?(r.push("-set_serial"),p.isNumber(e.serial)?r.push("0x"+("0000000000000000000000000000000000000000"+e.serial.toString(16)).slice(-40)):p.isHex(e.serial)?(e.serial.startsWith("0x")&&(e.serial=e.serial.substring(2,e.serial.length)),r.push("0x"+("0000000000000000000000000000000000000000"+e.serial).slice(-40))):r.push("0x"+("0000000000000000000000000000000000000000"+p.toHex(e.serial)).slice(-40))):(r.push("-CAcreateserial"),e.serialFile&&(r.push("-CAserial"),r.push(e.serialFile+".srl"))),e.serviceKeyPassword&&p.createPasswordFile({cipher:"",password:e.serviceKeyPassword,passType:"in"},r,f),s.push(e.serviceCertificate),s.push(e.serviceKey)):(r.push("-signkey"),r.push("--TMPFILE--"),e.serviceKeyPassword&&p.createPasswordFile({cipher:"",password:e.serviceKeyPassword,passType:"in"},r,f),s.push(e.serviceKey)),e.config)r.push("-extensions"),r.push("v3_req"),r.push("-extfile"),r.push("--TMPFILE--"),s.push(e.config);else if(e.extFile)r.push("-extfile"),r.push(e.extFile);else{var u=[];if(t&&t.san){for(var c=0;c<t.san.dns.length;c++)u.push("DNS."+(c+1)+" = "+t.san.dns[c]);for(var o=0;o<t.san.ip.length;o++)u.push("IP."+(o+1)+" = "+t.san.ip[o]);for(var d=0;d<t.san.email.length;d++)u.push("email."+(d+1)+" = "+t.san.email[d]);r.push("-extensions"),r.push("v3_req"),r.push("-extfile"),r.push("--TMPFILE--"),s.push(["[v3_req]","subjectAltName = @alt_names","[alt_names]",u.join(`
`)].join(`
`))}}e.clientKeyPassword&&p.createPasswordFile({cipher:"",password:e.clientKeyPassword,passType:"in"},r,f),E.exec(r,"CERTIFICATE",s,function(a,h){function v(l){if(l)return n(l);var y={csr:e.csr,clientKey:e.clientKey,certificate:h,serviceKey:e.serviceKey};return n(null,y)}p.deleteTempFiles(f,function(l){v(a||l)})})})}function fe(e,n){!n&&typeof e=="function"&&(n=e,e=void 0),e=(e||"").toString();var i;e.match(/BEGIN(\sNEW)? CERTIFICATE REQUEST/)?i=["req","-in","--TMPFILE--","-pubkey","-noout"]:e.match(/BEGIN RSA PRIVATE KEY/)||e.match(/BEGIN PRIVATE KEY/)?i=["rsa","-in","--TMPFILE--","-pubout"]:i=["x509","-in","--TMPFILE--","-pubkey","-noout"],E.exec(i,"PUBLIC KEY",e,function(t,r){return t?n(t):n(null,{publicKey:r})})}function j(e,n){!n&&typeof e=="function"&&(n=e,e=void 0),e=(e||"").toString();var i=e.match(/BEGIN(\sNEW)? CERTIFICATE REQUEST/),t=i?"req":"x509",r=[t,"-noout","-nameopt","RFC2253,sep_multiline,space_eq,-esc_msb,utf8","-text","-in","--TMPFILE--"];E.spawnWrapper(r,e,function(s,f,u,c){return s?n(s):c?n(c):cr(u,n)})}function ue(e,n,i,t){!t&&!i&&typeof n=="function"?(t=n,n=void 0,i=!1):!t&&i&&typeof i=="function"&&(t=i,i=!1),i&&i!=="md5"&&(i=!1),e=Buffer.isBuffer(e)&&e.toString()||e;var r="";e.match(/BEGIN(\sNEW)? CERTIFICATE REQUEST/)?r="req":e.match(/BEGIN RSA PRIVATE KEY/)||e.match(/BEGIN PRIVATE KEY/)?r="rsa":r="x509";var s=[r,"-noout","-modulus","-in","--TMPFILE--"],f=[];n&&p.createPasswordFile({cipher:"",password:n,passType:"in"},s,f),E.spawnWrapper(s,e,function(u,c,o,d){function a(h){if(h)return t(h);var v=o.match(/Modulus=([0-9a-fA-F]+)$/m);return v?t(null,{modulus:i?ge(i)(v[1]):v[1]}):t(new Error("No modulus"))}p.deleteTempFiles(f,function(h){a(u||h||d)})})}function ae(e,n){e=Buffer.isBuffer(e)&&e.toString()||e;var i=["dhparam","-text","-in","--TMPFILE--"];E.spawnWrapper(i,e,function(t,r,s,f){if(t)return n(t);if(f)return n(f);var u={},c=s.match(/Parameters: \((\d+) bit\)/);c&&(u.size=Number(c[1]));var o="";return s.split(`
`).forEach(function(d){/\s+([0-9a-f][0-9a-f]:)+[0-9a-f]?[0-9a-f]?/g.test(d)&&(o+=d.trim())}),o&&(u.prime=o),!c&&!o?n(new Error("No DH info found")):n(null,u)})}function or(e){Object.keys(e).forEach(function(n){E.set(n,e[n])})}function oe(e,n,i){!i&&typeof n=="function"&&(i=n,n=void 0),n=n||"sha1";var t=["x509","-in","--TMPFILE--","-fingerprint","-noout","-"+n];E.spawnWrapper(t,e,function(r,s,f,u){if(r)return i(r);if(u)return i(u);var c=f.match(/Fingerprint=([0-9a-fA-F:]+)$/m);return c?i(null,{fingerprint:c[1]}):i(new Error("No fingerprint"))})}function ce(e,n,i,t,r){!r&&typeof t=="function"&&(r=t,t={});var s=["pkcs12","-export"],f=[];t.cipher&&t.clientKeyPassword&&p.createPasswordFile({cipher:t.cipher,password:t.clientKeyPassword,passType:"in"},s,f),p.createPasswordFile({cipher:"",password:i,passType:"word"},s,f),s.push("-in"),s.push("--TMPFILE--"),s.push("-inkey"),s.push("--TMPFILE--");var u=[n,e];t.certFiles&&(u.push(t.certFiles.join("")),s.push("-certfile"),s.push("--TMPFILE--")),E.execBinary(s,u,function(c,o){function d(a){return a?r(a):r(null,{pkcs12:o})}p.deleteTempFiles(f,function(a){d(c||a)})})}function he(e,n,i){!i&&typeof n=="function"&&(i=n,n={}),n.p12Password=n.p12Password||"";var t=[],r=[],s=["pkcs12","-in",e];p.createPasswordFile({cipher:"",password:n.p12Password,passType:"in"},s,r),Buffer.isBuffer(e)&&(t=[e],s[2]="--TMPFILE--"),n.clientKeyPassword?p.createPasswordFile({cipher:"",password:n.clientKeyPassword,passType:"out"},s,r):s.push("-nodes"),E.execBinary(s,t,function(f,u){function c(o){var d={};if(o&&o.message.indexOf("No such file or directory")!==-1&&(o.code="ENOENT"),!o){var a=I(u,ur,ar);if(d.cert=a.shift(),d.ca=a,d.key=I(u,rr,nr).pop(),d.key)return E.exec(["rsa","-in","--TMPFILE--"],"RSA PRIVATE KEY",[d.key],function(h,v){return d.key=v,i(h,d)});n.clientKeyPassword?d.key=I(u,sr,fr).pop():d.key=I(u,ir,tr).pop()}return i(o,d)}p.deleteTempFiles(r,function(o){c(f||o)})})}function de(e,n,i){var t,r=[];!i&&typeof n=="function"&&(i=n,n=void 0),e=(e||"").toString(),e.match(/BEGIN(\sNEW)? CERTIFICATE REQUEST/)?t=["req","-text","-noout","-verify","-in","--TMPFILE--"]:e.match(/BEGIN RSA PRIVATE KEY/)||e.match(/BEGIN PRIVATE KEY/)?t=["rsa","-noout","-check","-in","--TMPFILE--"]:t=["x509","-text","-noout","-in","--TMPFILE--"],n&&p.createPasswordFile({cipher:"",password:n,passType:"in"},t,r),E.spawnWrapper(t,e,function(s,f,u,c){function o(d){if(d&&d.toString().trim()!=="verify OK")return i(d);var a;switch(t[0]){case"rsa":a=/^Rsa key ok$/i.test(u.trim());break;default:a=/Signature Algorithm/im.test(u);break}i(null,a)}p.deleteTempFiles(r,function(d){o(s||d||c)})})}function ve(e,n,i){!i&&typeof n=="function"&&(i=n,n="");var t=[],r=[],s=["pkcs12","-info","-in",e,"-noout","-maciter","-nodes"];p.createPasswordFile({cipher:"",password:n,passType:"in"},s,r),Buffer.isBuffer(e)&&(t=[e],s[3]="--TMPFILE--"),E.spawnWrapper(s,t,function(f,u,c,o){function d(a){if(a)return i(a);i(null,/MAC verified OK/im.test(o)||!/MAC verified OK/im.test(o)&&!/Mac verify error/im.test(o))}p.deleteTempFiles(r,function(a){d(f||a)})})}function le(e,n,i){!i&&typeof n=="function"&&(i=n,n=void 0),Array.isArray(e)||(e=[e]),!Array.isArray(n)&&n!==void 0&&n!==""&&(n=[n]);var t=[];n!==void 0&&t.push(n.join(`
`)),t.push(e.join(`
`));var r=["verify"];n!==void 0&&(r.push("-CAfile"),r.push("--TMPFILE--")),r.push("--TMPFILE--"),E.spawnWrapper(r,t,function(s,f,u,c){if(s)return i(s);i(null,u.trim().slice(-4)===": OK")})}function cr(e,n){try{e=(e||"").toString();var i,t,r,s,f={issuer:{}},u={},c,o,d;if((i=e.match(/\s*Serial Number:\r?\n?\s*([^\r\n]*)\r?\n\s*\b/))&&i.length>1&&(f.serial=i[1]),(t=e.match(/\s*Subject:\r?\n(\s*(([a-zA-Z0-9.]+)\s=\s[^\r\n]+\r?\n))*\s*\b/))&&t.length>1){if(t=t[0],r=m(t,/\s([a-zA-Z0-9.]+)\s=\s([^\r\n].*)/g),r)for(d=0;d<r.length;d++)o=r[d][1].trim(),!(o.match("(C|ST|L|O|OU|CN|emailAddress|DC)")||o==="")&&(f[o]=r[d][2].trim());r=t.match(/\sC\s=\s([^\r\n].*?)[\r\n]/),f.country=r&&r[1]||"",r=t.match(/\sST\s=\s([^\r\n].*?)[\r\n]/),f.state=r&&r[1]||"",r=t.match(/\sL\s=\s([^\r\n].*?)[\r\n]/),f.locality=r&&r[1]||"",r=m(t,/\sO\s=\s([^\r\n].*)/g),f.organization=r?r.length>1?r.sort(function(a,h){var v=a[1].toUpperCase(),l=h[1].toUpperCase();return l>v?-1:v>l?1:0}).sort(function(a,h){return a[1].length-h[1].length}).map(function(a){return a[1]}):r[0][1]:"",r=m(t,/\sOU\s=\s([^\r\n].*)/g),f.organizationUnit=r?r.length>1?r.sort(function(a,h){var v=a[1].toUpperCase(),l=h[1].toUpperCase();return l>v?-1:v>l?1:0}).sort(function(a,h){return a[1].length-h[1].length}).map(function(a){return a[1]}):r[0][1]:"",r=m(t,/\sCN\s=\s([^\r\n].*)/g),f.commonName=r?r.length>1?r.sort(function(a,h){var v=a[1].toUpperCase(),l=h[1].toUpperCase();return l>v?-1:v>l?1:0}).sort(function(a,h){return a[1].length-h[1].length}).map(function(a){return a[1]}):r[0][1]:"",r=m(t,/emailAddress\s=\s([^\r\n].*)/g),f.emailAddress=r?r.length>1?r.sort(function(a,h){var v=a[1].toUpperCase(),l=h[1].toUpperCase();return l>v?-1:v>l?1:0}).sort(function(a,h){return a[1].length-h[1].length}).map(function(a){return a[1]}):r[0][1]:"",r=m(t,/\sDC\s=\s([^\r\n].*)/g),f.dc=r?r.length>1?r.sort(function(a,h){var v=a[1].toUpperCase(),l=h[1].toUpperCase();return l>v?-1:v>l?1:0}).sort(function(a,h){return a[1].length-h[1].length}).map(function(a){return a[1]}):r[0][1]:""}if((s=e.match(/\s*Issuer:\r?\n(\s*([a-zA-Z0-9.]+)\s=\s[^\r\n].*\r?\n)*\s*\b/))&&s.length>1){for(s=s[0],r=m(s,/\s([a-zA-Z0-9.]+)\s=\s([^\r\n].*)/g),d=0;d<r.length;d++)o=r[d][1].toString(),!o.match("(C|ST|L|O|OU|CN|emailAddress|DC)")&&(f.issuer[o]=r[d][2].toString());r=s.match(/\sC\s=\s([^\r\n].*?)[\r\n]/),f.issuer.country=r&&r[1]||"",r=s.match(/\sST\s=\s([^\r\n].*?)[\r\n]/),f.issuer.state=r&&r[1]||"",r=s.match(/\sL\s=\s([^\r\n].*?)[\r\n]/),f.issuer.locality=r&&r[1]||"",r=m(s,/\sO\s=\s([^\r\n].*)/g),f.issuer.organization=r?r.length>1?r.sort(function(a,h){var v=a[1].toUpperCase(),l=h[1].toUpperCase();return l>v?-1:v>l?1:0}).sort(function(a,h){return a[1].length-h[1].length}).map(function(a){return a[1]}):r[0][1]:"",r=m(s,/\sOU\s=\s([^\r\n].*)/g),f.issuer.organizationUnit=r?r.length>1?r.sort(function(a,h){var v=a[1].toUpperCase(),l=h[1].toUpperCase();return l>v?-1:v>l?1:0}).sort(function(a,h){return a[1].length-h[1].length}).map(function(a){return a[1]}):r[0][1]:"",r=m(s,/\sCN\s=\s([^\r\n].*)/g),f.issuer.commonName=r?r.length>1?r.sort(function(a,h){var v=a[1].toUpperCase(),l=h[1].toUpperCase();return l>v?-1:v>l?1:0}).sort(function(a,h){return a[1].length-h[1].length}).map(function(a){return a[1]}):r[0][1]:"",r=m(s,/\sDC\s=\s([^\r\n].*)/g),f.issuer.dc=r?r.length>1?r.sort(function(a,h){var v=a[1].toUpperCase(),l=h[1].toUpperCase();return l>v?-1:v>l?1:0}).sort(function(a,h){return a[1].length-h[1].length}).map(function(a){return a[1]}):r[0][1]:""}(c=e.match(/X509v3 Subject Alternative Name: \r?\n([^\r\n]*)\r?\n/))&&c.length>1&&(c=c[1].trim()+`
`,f.san={},r=W("DNS:([^,\\r\\n].*?)[,\\r\\n\\s]",c),f.san.dns=r||"",r=W("IP Address:([^,\\r\\n].*?)[,\\r\\n\\s]",c),f.san.ip=r||"",r=W("email:([^,\\r\\n].*?)[,\\r\\n\\s]",c),f.san.email=r||""),(r=e.match(/Not Before\s?:\s?([^\r\n]*)\r?\n/))&&r.length>1&&(u.start=Date.parse(r&&r[1]||"")),(r=e.match(/Not After\s?:\s?([^\r\n]*)\r?\n/))&&r.length>1&&(u.end=Date.parse(r&&r[1]||"")),u.start&&u.end&&(f.validity=u),(r=e.match(/Signature Algorithm: ([^\r\n]*)\r?\n/))&&r.length>1&&(f.signatureAlgorithm=r&&r[1]||""),(r=e.match(/Public[ -]Key: ([^\r\n]*)\r?\n/))&&r.length>1&&(f.publicKeySize=(r&&r[1]||"").replace(/[()]/g,"")),(r=e.match(/Public Key Algorithm: ([^\r\n]*)\r?\n/))&&r.length>1&&(f.publicKeyAlgorithm=r&&r[1]||""),n(null,f)}catch(a){n(a)}}function m(e,n){var i=[];return e.replace(n,function(){var t=[].slice.call(arguments,0),r=t.splice(-2);t.index=r[0],t.input=r[1],i.push(t)}),i.length?i:null}function W(e,n){for(var i=new RegExp(e,"g"),t=n.match(i)||[],r=[],s,f,u=0;u<t.length;u++)s=new RegExp(e),f=t[u].match(s),r.push(f[1]);return r}function hr(e){e=e||{};var n={C:e.country||e.C,ST:e.state||e.ST,L:e.locality||e.L,O:e.organization||e.O,OU:e.organizationUnit||e.OU,CN:e.commonName||e.CN||"localhost",DC:e.dc||e.DC||"",emailAddress:e.emailAddress},i=Object.keys(n).map(function(t){if(n[t])if(typeof n[t]=="object"&&n[t].length>=1){var r="";return n[t].map(function(s){r+="/"+t+"="+s.replace(/[^\w .*\-,@']+/g," ").trim()}),r}else return"/"+t+"="+n[t].replace(/[^\w .*\-,@']+/g," ").trim()});return i.join("")}function I(e,n,i){Buffer.isBuffer(e)&&(e=e.toString("utf8"));var t=[];if(!e)return t;for(var r=e.indexOf(n);r!==-1;){e=e.substring(r);var s=e.indexOf(i);if(s===-1)break;s+=i.length,t.push(e.substring(0,s)),r=e.indexOf(n,s)}return t}var dr=g.promisified={createPrivateKey:P(N),createDhparam:P(te),createEcparam:P(se),createCSR:P(_),createCertificate:P(K),readCertificateInfo:P(j),getPublicKey:P(fe),getFingerprint:P(oe),getModulus:P(ue),getDhparamInfo:P(ae),createPkcs12:P(ce),readPkcs12:P(he),verifySigningChain:P(le),checkCertificate:P(de),checkPkcs12:P(ve)};const lr=Ee({__proto__:null,checkCertificate:Ve,checkPkcs12:be,config:ke,convert:er,createCSR:qe,createCertificate:je,createDhparam:Ye,createEcparam:$e,createPkcs12:ze,createPrivateKey:De,default:g,getDhparamInfo:Qe,getFingerprint:He,getModulus:Xe,getPublicKey:Be,promisified:dr,readCertificateInfo:Ge,readPkcs12:Ze,verifySigningChain:Je},[g]);export{lr as p};
//# sourceMappingURL=pem-55d04230.js.map
